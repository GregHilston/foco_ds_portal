
{% extends "_base.html" %}

{% block content %}

    <div class="container">
        <h1 class="mt-5">Stoltzmaniac - Data Model</h1>
        <form id="randomDataForm" class="form" method="POST" action="" role="form", enctype="multipart/form-data">
        {{ myform.csrf_token }}
        <div class="form-group">
            <strong>{{ myform.file.label }}</strong>
            {{ myform.file(placeholder="Upload File", class_="form-control")}}
        </div>
        <p><input class="btn btn-primary" type="submit" value="Submit"></p>
    </form>
    <hr>
    <div class="container">
        {% if df_head %}
            {{ df_head | safe}}
        {% endif %}
    </div>
    <div class="container">
        {% if data_columns %}
            <h4>Choose Dependent Variable</h4>
            <ul>
                {% for dc in data_columns %}
                    <li><button id={{ dc }}><div class="dep_var">{{ dc }}</div></button></li>
                {% endfor %}
            </ul>
        {% endif %}
    </div>

    Model Results
    <div id="regression_results"></div>

    </div>



    <script type=text/javascript>
        $(document).ready(function () {
            var file_location = "{{ filename | safe}}";
            var dependent_variable = "";

            $(".dep_var").click(function () {
                dependent_variable = $(this).text();
                $.ajax({
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    url: "./regression/" + dependent_variable,
                    data: {'file_location': file_location },
                    success: function(result){
                        console.log(result);
                        $("#regression_results").html(JSON.stringify(result));
                    }
                });
            });
        });
    </script>

{% endblock %}
